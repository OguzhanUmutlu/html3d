!function(){let e={type:"change"},t={type:"start"},o={type:"end"};class n extends THREE.EventDispatcher{constructor(n,c){super(),void 0===c&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),c===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');let i=this,a={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=n,this.domElement=c,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN},this.target=new THREE.Vector3;let r=new THREE.Vector3,s=1,p=a.NONE,d=a.NONE,l=0,m=0,h=0,u=new THREE.Vector3,E=new THREE.Vector2,y=new THREE.Vector2,g=new THREE.Vector3,b=new THREE.Vector2,$=new THREE.Vector2,O=new THREE.Vector2,v=new THREE.Vector2,f=[],j={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){let e=i.domElement.getBoundingClientRect(),t=i.domElement.ownerDocument.documentElement;i.screen.left=e.left+window.pageXOffset-t.clientLeft,i.screen.top=e.top+window.pageYOffset-t.clientTop,i.screen.width=e.width,i.screen.height=e.height};let T=function(){let e=new THREE.Vector2;return function t(o,n){return e.set((o-i.screen.left)/i.screen.width,(n-i.screen.top)/i.screen.height),e}}(),w=function(){let e=new THREE.Vector2;return function t(o,n){return e.set((o-.5*i.screen.width-i.screen.left)/(.5*i.screen.width),(i.screen.height+2*(i.screen.top-n))/i.screen.width),e}}();function N(e){var o;!1!==i.enabled&&(0===f.length&&(i.domElement.setPointerCapture(e.pointerId),i.domElement.addEventListener("pointermove",_),i.domElement.addEventListener("pointerup",L)),o=e,f.push(o),"touch"===e.pointerType?function e(o){if(D(o),1===f.length)p=a.TOUCH_ROTATE,y.copy(w(f[0].pageX,f[0].pageY)),E.copy(y);else{p=a.TOUCH_ZOOM_PAN;let n=f[0].pageX-f[1].pageX,c=f[0].pageY-f[1].pageY;m=l=Math.sqrt(n*n+c*c);let r=(f[0].pageX+f[1].pageX)/2,s=(f[0].pageY+f[1].pageY)/2;O.copy(T(r,s)),v.copy(O)}i.dispatchEvent(t)}(e):function e(o){if(p===a.NONE)switch(o.button){case i.mouseButtons.LEFT:p=a.ROTATE;break;case i.mouseButtons.MIDDLE:p=a.ZOOM;break;case i.mouseButtons.RIGHT:p=a.PAN}let n=d!==a.NONE?d:p;n!==a.ROTATE||i.noRotate?n!==a.ZOOM||i.noZoom?n!==a.PAN||i.noPan||(O.copy(T(o.pageX,o.pageY)),v.copy(O)):(b.copy(T(o.pageX,o.pageY)),$.copy(b)):(y.copy(w(o.pageX,o.pageY)),E.copy(y)),i.dispatchEvent(t)}(e))}function _(e){!1!==i.enabled&&("touch"===e.pointerType?function e(t){if(D(t),1===f.length)E.copy(y),y.copy(w(t.pageX,t.pageY));else{let o=function e(t){let o=t.pointerId===f[0].pointerId?f[1]:f[0];return j[o.pointerId]}(t),n=t.pageX-o.x,c=t.pageY-o.y;m=Math.sqrt(n*n+c*c);let i=(t.pageX+o.x)/2,a=(t.pageY+o.y)/2;v.copy(T(i,a))}}(e):function e(t){let o=d!==a.NONE?d:p;o!==a.ROTATE||i.noRotate?o!==a.ZOOM||i.noZoom?o!==a.PAN||i.noPan||v.copy(T(t.pageX,t.pageY)):$.copy(T(t.pageX,t.pageY)):(E.copy(y),y.copy(w(t.pageX,t.pageY)))}(e))}function L(e){!1!==i.enabled&&("touch"===e.pointerType?function e(t){switch(f.length){case 0:p=a.NONE;break;case 1:p=a.TOUCH_ROTATE,y.copy(w(t.pageX,t.pageY)),E.copy(y);break;case 2:p=a.TOUCH_ZOOM_PAN,y.copy(w(t.pageX-E.x,t.pageY-E.y)),E.copy(y)}i.dispatchEvent(o)}(e):(p=a.NONE,i.dispatchEvent(o)),R(e),0===f.length&&(i.domElement.releasePointerCapture(e.pointerId),i.domElement.removeEventListener("pointermove",_),i.domElement.removeEventListener("pointerup",L)))}function A(e){R(e)}function C(e){!1!==i.enabled&&(window.removeEventListener("keydown",C),d===a.NONE&&(e.code!==i.keys[a.ROTATE]||i.noRotate?e.code!==i.keys[a.ZOOM]||i.noZoom?e.code!==i.keys[a.PAN]||i.noPan||(d=a.PAN):d=a.ZOOM:d=a.ROTATE))}function V(){!1!==i.enabled&&(d=a.NONE,window.addEventListener("keydown",C))}function k(e){if(!1!==i.enabled&&!0!==i.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:b.y-=.025*e.deltaY;break;case 1:b.y-=.01*e.deltaY;break;default:b.y-=25e-5*e.deltaY}i.dispatchEvent(t),i.dispatchEvent(o)}}function P(e){!1!==i.enabled&&e.preventDefault()}function R(e){delete j[e.pointerId];for(let t=0;t<f.length;t++)if(f[t].pointerId==e.pointerId){f.splice(t,1);return}}function D(e){let t=j[e.pointerId];void 0===t&&(t=new THREE.Vector2,j[e.pointerId]=t),t.set(e.pageX,e.pageY)}this.rotateCamera=function(){let e=new THREE.Vector3,t=new THREE.Quaternion,o=new THREE.Vector3,n=new THREE.Vector3,c=new THREE.Vector3,a=new THREE.Vector3;return function r(){a.set(y.x-E.x,y.y-E.y,0);let s=a.length();s?(u.copy(i.object.position).sub(i.target),o.copy(u).normalize(),n.copy(i.object.up).normalize(),c.crossVectors(n,o).normalize(),n.setLength(y.y-E.y),c.setLength(y.x-E.x),a.copy(n.add(c)),e.crossVectors(a,u).normalize(),s*=i.rotateSpeed,t.setFromAxisAngle(e,s),u.applyQuaternion(t),i.object.up.applyQuaternion(t),g.copy(e),h=s):!i.staticMoving&&h&&(h*=Math.sqrt(1-i.dynamicDampingFactor),u.copy(i.object.position).sub(i.target),t.setFromAxisAngle(g,h),u.applyQuaternion(t),i.object.up.applyQuaternion(t)),E.copy(y)}}(),this.zoomCamera=function(){let e;p===a.TOUCH_ZOOM_PAN?(e=l/m,l=m,i.object.isPerspectiveCamera?u.multiplyScalar(e):i.object.isOrthographicCamera?(i.object.zoom/=e,i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(1!=(e=1+($.y-b.y)*i.zoomSpeed)&&e>0&&(i.object.isPerspectiveCamera?u.multiplyScalar(e):i.object.isOrthographicCamera?(i.object.zoom/=e,i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),i.staticMoving?b.copy($):b.y+=($.y-b.y)*this.dynamicDampingFactor)},this.panCamera=function(){let e=new THREE.Vector2,t=new THREE.Vector3,o=new THREE.Vector3;return function n(){if(e.copy(v).sub(O),e.lengthSq()){if(i.object.isOrthographicCamera){let c=(i.object.right-i.object.left)/i.object.zoom/i.domElement.clientWidth,a=(i.object.top-i.object.bottom)/i.object.zoom/i.domElement.clientWidth;e.x*=c,e.y*=a}e.multiplyScalar(u.length()*i.panSpeed),o.copy(u).cross(i.object.up).setLength(e.x),o.add(t.copy(i.object.up).setLength(e.y)),i.object.position.add(o),i.target.add(o),i.staticMoving?O.copy(v):O.add(e.subVectors(v,O).multiplyScalar(i.dynamicDampingFactor))}}}(),this.checkDistances=function(){i.noZoom&&i.noPan||(u.lengthSq()>i.maxDistance*i.maxDistance&&(i.object.position.addVectors(i.target,u.setLength(i.maxDistance)),b.copy($)),u.lengthSq()<i.minDistance*i.minDistance&&(i.object.position.addVectors(i.target,u.setLength(i.minDistance)),b.copy($)))},this.update=function(){u.subVectors(i.object.position,i.target),i.noRotate||i.rotateCamera(),i.noZoom||i.zoomCamera(),i.noPan||i.panCamera(),i.object.position.addVectors(i.target,u),i.object.isPerspectiveCamera?(i.checkDistances(),i.object.lookAt(i.target),r.distanceToSquared(i.object.position)>1e-6&&(i.dispatchEvent(e),r.copy(i.object.position))):i.object.isOrthographicCamera?(i.object.lookAt(i.target),(r.distanceToSquared(i.object.position)>1e-6||s!==i.object.zoom)&&(i.dispatchEvent(e),r.copy(i.object.position),s=i.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){p=a.NONE,d=a.NONE,i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.up.copy(i.up0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),u.subVectors(i.object.position,i.target),i.object.lookAt(i.target),i.dispatchEvent(e),r.copy(i.object.position),s=i.object.zoom},this.dispose=function(){i.domElement.removeEventListener("contextmenu",P),i.domElement.removeEventListener("pointerdown",N),i.domElement.removeEventListener("pointercancel",A),i.domElement.removeEventListener("wheel",k),i.domElement.removeEventListener("pointermove",_),i.domElement.removeEventListener("pointerup",L),window.removeEventListener("keydown",C),window.removeEventListener("keyup",V)},this.domElement.addEventListener("contextmenu",P),this.domElement.addEventListener("pointerdown",N),this.domElement.addEventListener("pointercancel",A),this.domElement.addEventListener("wheel",k,{passive:!1}),window.addEventListener("keydown",C),window.addEventListener("keyup",V),this.handleResize(),this.update()}}THREE.TrackballControls=n}();